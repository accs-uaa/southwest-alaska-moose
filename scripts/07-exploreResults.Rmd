---
title: "Seasonal movements and home ranges of moose in southwest Alaska"
author: "Amanda Droghini"
date: "6/3/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r load, include=FALSE}
rm(list=ls())
source("C:/Users/adroghini/Documents/GitHub/southwest-alaska-moose/telemetry/scripts/init.R")
hrSize <- read_csv("C:/Users/adroghini/Documents/GitHub/southwest-alaska-moose/telemetry/output/homeRangeSizes.csv")
hrOverlap <- read_csv("C:/Users/adroghini/Documents/GitHub/southwest-alaska-moose/telemetry/output/homeRangeOverlap.csv")
```


```{r plot parameters, include=FALSE}
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
```


# Objectives:

1. Describe home range size
2. Describe philopatry: % overlap across years
3. What proportion of the population are (long-distance) migrants? For this we can look at:
  a) % overlap between seasonal home ranges
  b) distance between seasonal home ranges
4. Relate variation in home range size and season to environmental covariates

## Variation in home range size
```{r format,echo=FALSE}
hrSize <- hrSize %>% 
  mutate(season = word(.id,start=3,sep="_"),
         year = word(.id,start=2,sep="_"),
         id = word(.id,start=1,sep="_")) %>% 
  rename(modelName = .id) %>% 
  dplyr::select(modelName,season,year,id,everything())
```

What is the distribution of home range sizes across individuals?
```{r plot HR size by season, echo=FALSE}

hrSize %>%
  ggplot(aes(x=est,fill = factor(season))) + 
  geom_histogram(binwidth=20,color="grey20")  + 
  scale_fill_manual(values=cbPalette,name="Season") +
  scale_x_continuous(name = "Home range size (sq. km)",breaks=seq(0,160,by=20))+
  scale_y_continuous(name="Frequency",breaks=seq(0,20,by=3),limits = c(0,15))+
  theme_minimal()+
  theme(legend.position = "top")
```

```{r summarize HR size by season,echo=FALSE}
knitr::kable(hrSize %>% group_by(season) %>% 
               summarise(
                        mean = round(mean(est),2),
                         "standard deviation" = round(sd(est),2),
                         maximum = round(max(est),2),
                        minimum = round(min(est),2),
                         n = length(est)))
```


Does home range size tend to be consistent from one year to the next?
``` {r plot difference, echo=FALSE}
hrSize %>% filter(season=="summer") %>% group_by(id) %>% 
  pivot_wider(values_from=est,names_from=year,id_cols=id) %>% 
  mutate(difference = abs(y1 - y2)) %>% 
  filter(!is.na(difference)) %>% 
  ggplot(aes(x=y1,y=y2,label = id))+
  geom_abline(slope=1, intercept=0,linetype=3)+
  geom_text(size = 3.25,nudge_x = 0,nudge_y = -5,label.padding = unit(0.1, "lines")) +
  geom_point(size=2, shape=21,fill=cbPalette[8],color="black") +
  scale_x_continuous(name="Year 1",limits=c(0,100),breaks=seq(0,200,by=20))+
  scale_y_continuous(name="Year 2",limits=c(0,160),breaks=seq(0,200,by=40))+
  theme_bw()+
  theme(panel.grid.minor = element_blank(),
        panel.border = element_blank(),
          axis.line = element_line(colour = "black"))
```


## Spatial overlap in home range across seasons

Within individuals.

Could easily be adapted to looking @ within seasons, across individuals.

```{r plot overlap}
homeRangeOverlap %>% mutate(id.no = seq(1:nrow(homeRangeOverlap))) %>% 
  ggplot(aes(y=est,x=id.no,fill=seasons))+
  geom_point(size=2,pch=21) + 
  scale_fill_manual(values=cbPalette) +
  scale_x_continuous(name="Home range pairs") +
  scale_y_continuous(name="Proportion of overlap") +
  theme_minimal() +
  theme(legend.position = "right",axis.text.x=element_blank())
```

